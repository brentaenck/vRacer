<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vRacer - Vector Racing Game</title>
    <meta name="description" content="Professional vector racing game with multi-player support, realistic physics, and competitive gameplay" />
    <meta name="theme-color" content="#00d4ff" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3e%3ctext y='.9em' font-size='90'%3eüèÅ%3c/text%3e%3c/svg%3e" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <!-- Paper-based hand-drawn fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Architects+Daughter:wght@400&family=Kalam:wght@300;400;700&family=Caveat:wght@400;500;600;700&family=Patrick+Hand:wght@400&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body>
    <div id="app">
      <header role="banner" class="ui-zone">
        <div class="header-brand">
          <h1>
            üèÅ vRacer
            <span class="version">v4.4.0</span>
          </h1>
          <p class="tagline">Professional Vector Racing</p>
        </div>
        
        <div id="gameHUD" class="game-hud">
          <div class="hud-section">
            <div id="playerInfo" class="hud-info"></div>
            <div id="gameStatus" class="hud-status"></div>
          </div>
          <div id="performanceMetrics" class="hud-metrics"></div>
        </div>
        
        <nav class="controls" role="navigation" aria-label="Game controls">
          <button id="resetBtn" title="New Game (R key)" class="btn-reset-header" aria-label="Start new game">
            <span class="btn-icon">üîÑ</span>
            New Game
          </button>
          <div class="dropdown-menu-container">
            <button id="menuBtn" title="Menu" class="btn-menu" aria-label="Open menu" aria-expanded="false" aria-haspopup="menu">
              <span class="hamburger-icon">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
              </span>
            </button>
            <div id="dropdownMenu" class="dropdown-menu" role="menu" aria-hidden="true">
              <button id="gameSettingsBtn" class="menu-item" role="menuitem" tabindex="-1">
                <span class="menu-icon">‚öôÔ∏è</span>
                <span class="menu-text">Game Settings</span>
              </button>
              <hr class="menu-separator">
              <button id="trackEditorBtn" class="menu-item" role="menuitem" tabindex="-1">
                <span class="menu-icon">üèÅ</span>
                <span class="menu-text">Track Editor</span>
              </button>
              <button id="loadTrackBtn" class="menu-item" role="menuitem" tabindex="-1">
                <span class="menu-icon">üìÅ</span>
                <span class="menu-text">Load Track from File</span>
              </button>
              <button id="restoreDefaultTrackBtn" class="menu-item" role="menuitem" tabindex="-1">
                <span class="menu-icon">üîÑ</span>
                <span class="menu-text">Restore Default Track</span>
              </button>
              <hr class="menu-separator">
              <div class="menu-info" id="currentTrackInfo">
                <span class="menu-icon">üìç</span>
                <span class="menu-text">Track: Default vRacer Track</span>
              </div>
            </div>
          </div>
        </nav>
      </header>
      
      <main role="main">
        <section class="game-area canvas-zone">
          <canvas 
            id="canvas" 
            class="canvas-zone"
            width="1000" 
            height="700" 
            role="application"
            aria-label="vRacer game canvas - use mouse to select moves or keyboard controls"
            tabindex="0"
          ></canvas>
          <div class="game-overlay" id="gameOverlay">
            <!-- Dynamic overlay content will be inserted here -->
          </div>
        </section>
        
        <aside id="sidebar" class="ui-zone" role="complementary" aria-label="Game information and help">
          <section class="status-section">
            <h2>
              <span class="section-icon">üìä</span>
              Game Status
            </h2>
            <div id="status" role="log" aria-live="polite"></div>
          </section>
          
          <section class="help-section">
            <h2>
              <span class="section-icon">‚ùì</span>
              How to Play
            </h2>
            <div class="help-content">
              <div class="help-category">
                <h3>üéØ Objective</h3>
                <ul>
                  <li>Complete the <strong>required laps</strong> around the track (1-10 laps)</li>
                  <li>Cross the <strong>checkered finish line</strong> in the correct direction</li>
                  <li>Beat other players in multi-car races!</li>
                </ul>
              </div>
              
              <div class="help-category">
                <h3>üïπÔ∏è Controls</h3>
                <ul>
                  <li><strong>Mouse:</strong> Click highlighted nodes to move</li>
                  <li><strong>Keyboard:</strong> WASD or arrow keys</li>
                  <li><strong>Diagonals:</strong> Q/E/Z/X keys</li>
                  <li><strong>Coast:</strong> Space or Enter (no acceleration)</li>
                  <li><strong>Undo:</strong> U or Ctrl+Z</li>
                </ul>
              </div>
              
              <div class="help-category">
                <h3>‚ö° Physics</h3>
                <ul>
                  <li>Velocity changes by <strong>-1, 0, or +1</strong> each turn</li>
                  <li>Cars have <strong>momentum</strong> - plan ahead!</li>
                  <li>Stay within track boundaries to avoid crashing</li>
                  <li>Cars can <strong>collide</strong> with each other</li>
                </ul>
              </div>
              
              <div class="help-category">
                <h3>‚å®Ô∏è Shortcuts</h3>
                <ul>
                  <li><kbd>R</kbd> - Reset game</li>
                  <li><kbd>G</kbd> - Toggle grid</li>
                  <li><kbd>C</kbd> - Toggle move candidates</li>
                  <li><kbd>D</kbd> - Toggle debug info</li>
                  <li><kbd>Esc</kbd> - Close settings dialog</li>
                </ul>
                
                <div class="help-category">
                  <h3>‚öôÔ∏è Settings</h3>
                  <p>Click the <strong>hamburger menu</strong> (‚ò∞) in the header to access game settings including reset, display options, and developer tools.</p>
                </div>
              </div>
            </div>
          </section>
          
          <section class="features-section">
            <h2>
              <span class="section-icon">üöÄ</span>
              Features
            </h2>
            <div class="feature-badges">
              <span class="badge badge-enabled">Multi-Car Racing</span>
              <span class="badge badge-enabled">Car Collisions</span>
              <span class="badge badge-enabled">Advanced Controls</span>
              <span class="badge badge-enabled">Particle Effects</span>
              <span class="badge badge-enabled">Performance Metrics</span>
              <span class="badge badge-enabled">ü§ñ AI Players</span>
            </div>
          </section>
        </aside>
      </main>
      
      <footer role="contentinfo">
        <div class="footer-content">
          <div class="footer-info">
            <strong>vRacer v2.1.1</strong> ‚Ä¢
            <span class="text-accent">Professional Vector Racing Game</span>
          </div>
          <div class="footer-links">
            <span>MIT License</span> ‚Ä¢ 
            <a href="https://github.com/brentaenck/vRacer" target="_blank" rel="noopener" class="footer-link">
              View Source
            </a>
          </div>
        </div>
      </footer>
      
      <!-- Configuration Dialog Modal -->
      <div id="configModal" class="modal-overlay" role="dialog" aria-labelledby="config-title" aria-hidden="true">
        <div class="modal-content">
          <header class="modal-header">
            <h2 id="config-title">‚öôÔ∏è Game Settings</h2>
            <button id="closeConfigBtn" class="btn-close" aria-label="Close settings">
              <span>&times;</span>
            </button>
          </header>
          
          <div class="modal-body">
            
            <section class="config-section">
              <h3>üëÅÔ∏è Display Options</h3>
              <div class="config-group">
                <label class="config-toggle">
                  <input id="gridToggle" type="checkbox" checked />
                  <span class="toggle-slider"></span>
                  <div class="toggle-info">
                    <span class="toggle-label">Show Grid Coordinates</span>
                    <span class="toggle-desc">Display coordinate numbers at grid intersections</span>
                  </div>
                  <span class="shortcut">G</span>
                </label>
                
                <label class="config-toggle">
                  <input id="candToggle" type="checkbox" checked />
                  <span class="toggle-slider"></span>
                  <div class="toggle-info">
                    <span class="toggle-label">Show Moves</span>
                    <span class="toggle-desc">Highlight possible move candidates</span>
                  </div>
                  <span class="shortcut">C</span>
                </label>
              </div>
            </section>
            
            <section class="config-section">
              <h3>üèÅ Racing Line</h3>
              <div class="config-group">
                <label class="config-toggle">
                  <input id="racingLineToggle" type="checkbox" />
                  <span class="toggle-slider"></span>
                  <div class="toggle-info">
                    <span class="toggle-label">Show Racing Line</span>
                    <span class="toggle-desc">Display optimal racing path overlay</span>
                  </div>
                  <span class="shortcut">L</span>
                </label>
                
                <div class="racing-line-controls">
                  <button id="importRacingLineBtn" class="btn-import">
                    üìÅ Import Racing Line
                  </button>
                  <button id="clearRacingLineBtn" class="btn-clear" title="Clear custom racing line and use default">
                    üóëÔ∏è Clear Custom
                  </button>
                  <button id="openRacingLineEditorBtn" class="btn-editor" title="Open Racing Line Editor">
                    ‚úèÔ∏è Open Editor
                  </button>
                </div>
                
                <div id="racingLineStatus" class="racing-line-status">
                  <span id="racingLineInfo">Using default racing line</span>
                </div>
              </div>
            </section>
            
            <section class="config-section">
              <h3>üêõ Developer Options</h3>
              <div class="config-group">
                <label class="config-toggle">
                  <input id="debugToggle" type="checkbox" />
                  <span class="toggle-slider"></span>
                  <div class="toggle-info">
                    <span class="toggle-label">Debug Mode</span>
                    <span class="toggle-desc">Show performance metrics and debug info</span>
                  </div>
                  <span class="shortcut">D</span>
                </label>
              </div>
            </section>
          </div>
          
          <footer class="modal-footer">
            <p class="modal-hint">Press <kbd>Esc</kbd> to close this dialog</p>
          </footer>
        </div>
      </div>
      
      <!-- New Game Dialog Modal -->
      <div id="newGameModal" class="modal-overlay" role="dialog" aria-labelledby="new-game-title" aria-hidden="true">
        <div class="modal-content new-game-modal">
          <header class="modal-header">
            <h2 id="new-game-title">üèÅ New Game Setup</h2>
            <button id="closeNewGameBtn" class="btn-close" aria-label="Close new game dialog">
              <span>&times;</span>
            </button>
          </header>
          
          <div class="modal-body split-panel-body">
            <!-- Left Panel: Race Settings -->
            <div class="race-settings-panel">
              <section class="settings-section">
                <h3 class="section-title">üèÅ Race Settings</h3>
                
                <div class="settings-group">
                  <label class="setting-item">
                    <span class="setting-label">üë• Players</span>
                    <select id="playerCount" class="setting-select">
                      <option value="1">1 Player</option>
                      <option value="2" selected>2 Players</option>
                      <option value="3">3 Players</option>
                      <option value="4">4 Players</option>
                    </select>
                  </label>
                  
                  <label class="setting-item">
                    <span class="setting-label">üèÅ Laps</span>
                    <select id="lapCount" class="setting-select">
                      <option value="1">1 Lap (Sprint)</option>
                      <option value="2">2 Laps (Quick)</option>
                      <option value="3" selected>3 Laps (Standard)</option>
                      <option value="5">5 Laps (Extended)</option>
                      <option value="10">10 Laps (Endurance)</option>
                    </select>
                  </label>
                </div>
              </section>
              
              <section class="quick-setup-section">
                <h3 class="section-title">‚ö° Quick Setup</h3>
                <div class="preset-buttons">
                  <button type="button" class="preset-btn" data-preset="solo">
                    <span class="preset-icon">üéØ</span>
                    <div class="preset-content">
                      <span class="preset-name">Solo Practice</span>
                      <span class="preset-desc">1 Human + AI</span>
                    </div>
                  </button>
                  <button type="button" class="preset-btn" data-preset="local">
                    <span class="preset-icon">üë•</span>
                    <div class="preset-content">
                      <span class="preset-name">Local Multi</span>
                      <span class="preset-desc">2-4 Humans</span>
                    </div>
                  </button>
                  <button type="button" class="preset-btn" data-preset="ai-challenge">
                    <span class="preset-icon">ü§ñ</span>
                    <div class="preset-content">
                      <span class="preset-name">AI Challenge</span>
                      <span class="preset-desc">1 Human + 3 AI</span>
                    </div>
                  </button>
                </div>
              </section>
              
              <section class="race-preview-section">
                <h3 class="section-title">üìä Race Preview</h3>
                <div class="preview-stats">
                  <div class="preview-stat">
                    <span class="stat-value" id="humanCount">2</span>
                    <span class="stat-label">Humans</span>
                  </div>
                  <div class="preview-stat">
                    <span class="stat-value" id="aiCount">0</span>
                    <span class="stat-label">AI Players</span>
                  </div>
                  <div class="preview-stat">
                    <span class="stat-value" id="totalLaps">3</span>
                    <span class="stat-label">Laps</span>
                  </div>
                </div>
              </section>
            </div>
            
            <!-- Right Panel: Player Setup -->
            <div class="player-setup-panel">
              <section class="players-section">
                <h3 class="section-title">üéÆ Player Setup</h3>
                
                <div id="playerGrid" class="player-grid">
                  <!-- Player 1 -->
                  <div class="player-card" data-player="1">
                    <div class="player-card-header">
                      <div class="player-color" data-color="#ff4444"></div>
                      <span class="player-number">Player 1</span>
                    </div>
                    <div class="player-card-body">
                      <input type="text" class="player-name" value="Player 1" placeholder="Enter name...">
                      <div class="player-ai-controls">
                        <label class="ai-toggle">
                          <input type="checkbox" class="player-ai">
                          <span class="ai-toggle-slider"></span>
                          <span class="ai-toggle-label">AI</span>
                        </label>
                        <select class="player-ai-diff" style="display: none;">
                          <option value="easy">Easy</option>
                          <option value="medium" selected>Medium</option>
                          <option value="hard">Hard</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Player 2 -->
                  <div class="player-card" data-player="2">
                    <div class="player-card-header">
                      <div class="player-color" data-color="#44ff44"></div>
                      <span class="player-number">Player 2</span>
                    </div>
                    <div class="player-card-body">
                      <input type="text" class="player-name" value="Player 2" placeholder="Enter name...">
                      <div class="player-ai-controls">
                        <label class="ai-toggle">
                          <input type="checkbox" class="player-ai">
                          <span class="ai-toggle-slider"></span>
                          <span class="ai-toggle-label">AI</span>
                        </label>
                        <select class="player-ai-diff" style="display: none;">
                          <option value="easy">Easy</option>
                          <option value="medium" selected>Medium</option>
                          <option value="hard">Hard</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Player 3 -->
                  <div class="player-card" data-player="3" style="display: none;">
                    <div class="player-card-header">
                      <div class="player-color" data-color="#4488ff"></div>
                      <span class="player-number">Player 3</span>
                    </div>
                    <div class="player-card-body">
                      <input type="text" class="player-name" value="Player 3" placeholder="Enter name...">
                      <div class="player-ai-controls">
                        <label class="ai-toggle">
                          <input type="checkbox" class="player-ai">
                          <span class="ai-toggle-slider"></span>
                          <span class="ai-toggle-label">AI</span>
                        </label>
                        <select class="player-ai-diff" style="display: none;">
                          <option value="easy">Easy</option>
                          <option value="medium" selected>Medium</option>
                          <option value="hard">Hard</option>
                        </select>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Player 4 -->
                  <div class="player-card" data-player="4" style="display: none;">
                    <div class="player-card-header">
                      <div class="player-color" data-color="#ffcc00"></div>
                      <span class="player-number">Player 4</span>
                    </div>
                    <div class="player-card-body">
                      <input type="text" class="player-name" value="Player 4" placeholder="Enter name...">
                      <div class="player-ai-controls">
                        <label class="ai-toggle">
                          <input type="checkbox" class="player-ai">
                          <span class="ai-toggle-slider"></span>
                          <span class="ai-toggle-label">AI</span>
                        </label>
                        <select class="player-ai-diff" style="display: none;">
                          <option value="easy">Easy</option>
                          <option value="medium" selected>Medium</option>
                          <option value="hard">Hard</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </section>
            </div>
          </div>
          
          <footer class="modal-footer enhanced-footer">
            <div class="footer-status">
              <span id="raceStatus">Ready to race! 2 players, 3 laps</span>
            </div>
            <div class="footer-actions">
              <button id="randomSetupBtn" class="btn-secondary" title="Generate random player setup">
                üé≤ Randomize
              </button>
              <button id="startNewGameBtn" class="btn-action btn-primary">
                üèÅ Start Race
              </button>
            </div>
          </footer>
        </div>
      </div>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>

