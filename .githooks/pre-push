#!/bin/bash
# Pre-push hook for vRacer
# This hook runs before `git push` to ensure code quality

echo "ğŸš€ Running pre-push validation..."

# Run full CI pipeline (type-check + build)
echo "âš¡ Running TypeScript checks and build..."
npm run ci

if [ $? -ne 0 ]; then
    echo "âŒ Pre-push validation failed!"
    echo "Please fix TypeScript errors and build issues before pushing."
    exit 1
fi

# Run additional production build test
echo "ğŸ—ï¸  Testing production build..."
npm run build > /dev/null 2>&1

if [ $? -ne 0 ]; then
    echo "âŒ Production build test failed!"
    echo "Please ensure production build works before pushing."
    exit 1
fi

echo "âœ… Pre-push validation passed! Ready to push."
exit 0
