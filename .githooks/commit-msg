#!/bin/bash
# Commit message hook for vRacer
# Validates commit message format and provides helpful reminders

commit_regex='^(feat|fix|docs|style|refactor|test|chore|release)(\(.+\))?: .{1,100}'

if ! grep -qE "$commit_regex" "$1"; then
    echo "‚ùå Invalid commit message format!"
    echo ""
    echo "Commit message should follow conventional format:"
    echo "  type(scope): description"
    echo ""
    echo "Valid types: feat, fix, docs, style, refactor, test, chore, release"
    echo "Examples:"
    echo "  feat: add car collision detection"
    echo "  fix(ai): improve backward movement prevention"
    echo "  docs: update RELEASE_CHECKLIST.md"
    echo "  release: bump version to 2.3.0"
    echo ""
    echo "üìã Reminder: Check RELEASE_CHECKLIST.md for release process"
    exit 1
fi

# Check for version changes without proper release process
if grep -q "version.*:" "$1" && ! grep -qE "^(release|chore).*version" "$1"; then
    echo "‚ö†Ô∏è  Version change detected!"
    echo "üìã Remember to follow RELEASE_CHECKLIST.md for version bumps"
fi

echo "‚úÖ Commit message format is valid"
exit 0
